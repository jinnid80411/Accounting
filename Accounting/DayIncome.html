
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors"/>
    <meta name="generator" content="Jekyll v4.1.1"/>
    <title>記帳系統</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/4.5/examples/dashboard/"/>

     <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />    
    <link href="css/dashboard.css" rel="stylesheet"/>
    <!--other js-->
    <script src="js/Format.js"></script>
    <script src="js/Tools.js"></script>
    
    <script src="js/jquery-3.5.1.min.js"></script>
   <!-- <script src="js/jquery.min.js"></script> -->
   <script src="js/jquery.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/feather.min.js"></script>    
    <link href="bootstrapdatepicker/css/bootstrap-datepicker.css" rel="stylesheet" />
    <script src="bootstrapdatepicker/js/bootstrap-datepicker.js"></script>
    <script src="bootstrapdatepicker/locales/bootstrap-datepicker.zh-TW.min.js"></script>


    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <!-- Custom styles for this template -->
</head>
<body>
    <nav class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-md-3 col-lg-2 mr-0 px-3" href="#">記帳系統</a>
        <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-toggle="collapse" data-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
       
        <!--
    <ul class="form-control-dark w-100" type="text">
        <li class="nav-item text-nowrap ">
            <span style="font-size:18px;color:white;font-weight:bold;position:absolute;">支出品項管理</span>
        </li>
    </ul>
    -->
        <!--<span style="font-size:18px;color:white;font-weight:bold;">當日支出</span>-->
        <!--<input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search">-->
        <ul class="navbar-nav px-3">
            <li class="nav-item text-nowrap">
                <a class="nav-link" href="#">Sign in</a>
            </li>
        </ul>

    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Header -->
            <div id="header">
                
            </div>
            

            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
                    <section id="home">
                        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">

                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary" type="button" onclick="location.href = '#DAYSummation'">當日總額</button>
                                <button class="btn btn-outline-secondary" type="button" onclick="location.href = '#DAYIncome'">當日現金收入</button>
                                <button class="btn btn-outline-secondary" type="button" onclick="location.href = '#DAYOutcome'">當日支出</button>
                            </div>
                        </div>
                    </section>
                    <!-- 當日總額 -->
                    <section id="DAYSummation">
                        <h1 class="h2">當日總額</h1>
                        <div class="input-group" style="padding-top:5px">
                            <div class="input-group-prepend">
                                <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">當日現金</label>
                            </div>

                            <input type="text" id="Daily_output_sum" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01">元</label>
                            </div>
                        </div>
                        <div class="input-group" style="padding-top:5px">
                            <div class="input-group-prepend">
                                <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01" id="當日支出">當日支出</label>
                            </div>

                            <input type="text" id="Daily_expend_sum" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01">元</label>
                            </div>
                        </div>
                        <div class="input-group" style="padding-top:5px">
                            <div class="input-group-prepend">
                                <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">當日補零</label>
                            </div>

                            <input type="text" id="Daily_patch_change" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01">元</label>
                            </div>
                        </div>
                        <div class="input-group" style="padding-top:5px">
                            <div class="input-group-prepend">
                                <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">當日總計</label>
                            </div>

                            <input type="text" id="Daily_sum" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="inputGroupSelect01">元</label>
                            </div>
                        </div>
                        <br>
                        <div>
                            <input class="btn btn-outline-secondary" style="min-width:100%" type="button" onclick="Update_Daily_Account()" value="確認完成" />
                        </div>

                    </section>
                    <br>
                    <br>
                    <br>
                    <!-- 當日現金收入 -->
                    <section id="DAYIncome">
                        <div>
                            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                                <h1 class="h2" id="當日現金收入">當日現金收入</h1>
                                <div class="btn-toolbar mb-2 mb-md-0">
                                </div>
                            </div>


                            <div class="input-group" style="padding-top:5px">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">$1000</label>
                                </div>

                                <input type="text" id="input_1000" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="inputGroupSelect01">元</label>
                                </div>
                            </div>

                            <div class="input-group" style="padding-top:5px">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">$100</label>
                                </div>

                                <input type="text" id="input_100" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="inputGroupSelect01">元</label>
                                </div>
                            </div>

                            <div class="input-group" style="padding-top:5px">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">$50</label>
                                </div>

                                <input type="text" id="input_50" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="inputGroupSelect01">元</label>
                                </div>
                            </div>

                            <div class="input-group" style="padding-top:5px">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">$10</label>
                                </div>

                                <input type="text" id="input_10" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="inputGroupSelect01">元</label>
                                </div>
                            </div>

                            <div class="input-group" style="padding-top:5px">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">$5</label>
                                </div>

                                <input type="text" id="input_5" class="form-control" aria-label="Text input with segmented dropdown button" onchange="daily_sum()" />
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="inputGroupSelect01">元</label>
                                </div>
                            </div>

                            <div class="input-group" style="padding-top:5px">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" style="min-width:75px" for="inputGroupSelect01">總計</label>
                                </div>

                                <input type="text" id="output_sum" class="form-control" aria-label="Text input with segmented dropdown button" />
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="button" onclick="RunAjax_income('Save'); location.href = '#home';">送出</button>
                                </div>
                            </div>
                        </div>
                    </section>
                    <br>
                    <br>
                    <br>
                    <section id="DAYOutcome">
                        <div>
                            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                                <h1 class="h2">當日支出</h1>

                            </div>
                            <div class="input-group">
                                <label class="input-group-text" for="inputGroupSelect01">類別</label>
                                <select name="pets" id="category_List" class="form-control" aria-label="Text input with dropdown button" onchange="List_Expend_Item()"></select>
                                <label class="input-group-text" for="inputGroupSelect01">品項</label>
                                <select name="pets" id="cat_items" class="form-control" aria-label="Text input with dropdown button"></select>
                                <!-- <input type="text" id="category" class="form-control" aria-label="Text input with dropdown button"> -->
                            </div>
                            <div class="input-group-prepend">
                                <input type="text" id="cat_ExpendAmt" class="form-control" />
                                <input class="btn btn-outline-secondary" type="button" onclick="Add_Expend();" value="新增" />
                            </div>

                            <div id="SHORTCut">

                            </div>

                            <div class="input-group" style="padding-top:10px">



                                <table class="table table-bordered">
                                    <thead class="thead-light">
                                        <tr>
                                            <th scope="col" width="5%">序號</th>
                                            <th colspan="1" scope="col" width="25%">類別</th>
                                            <th colspan="1" scope="col" width="25%">品項</th>
                                            <th colspan="1" scope="col" width="25%">金額</th>
                                            <th colspan="1" scope="col" width="25%">修改</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbody1"></tbody>
                                    <tfoot>
                                        <tr>
                                            <th colspan="1" scope="col" width="25%">總數</th>
                                            <th colspan="1" scope="col" width="25%">
                                                <input type="text" id="Expend_count" class="form-control" aria-label="Text input with segmented dropdown button" />
                                            </th>
                                            <th colspan="1" scope="col" width="25%">總計</th>
                                            <th colspan="1" scope="col" width="25%">
                                                <input type="text" id="Total_Expend_Amt" class="form-control" aria-label="Text input with segmented dropdown button" />
                                            </th>
                                            <th colspan="2" scope="col" width="25%">
                                                <input class="btn btn-outline-secondary" type="button" onclick="location.href = '#home';Send_Expend();" value="送出" />
                                            </th>
                                        </tr>
                                    </tfoot>

                                </table>

                            </div>


                        </div>
                    </section>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>

                </main>
                
            </div>
        </div>
    </body>




    <script>

        var i = 0;
        var tot_Expend_amt = 0;
        var Expend_seq = 0;
        var cat_value = [{ code: "A", text: "商學院" }, { code: "B", text: "工學院" }];
        var item_value = [{ cat_code: "A", items_code: "1", items_text: "金融系" }, { cat_code: "A", items_code: "2", items_text: "商品系" },
            { cat_code: "B", items_code: "3", items_text: "資訊系" }, { cat_code: "B", items_code: "4", items_text: "電子系" }];
        var shortcut_value = [{ cat_code: "A", items_code: "2", cat_value: "商學院", item_value: "商品系" }, { cat_code: "B", items_code: "1", cat_value: "工學院", item_value: "金融系" }];

        $("#header").load("menu.html");
        Load();
        

        
        function Load()
        {
            
            Load_InCome()
            List_Expend_Category();
            Load_ShortCut();
            
        }

        
        function Load_InCome() //1.載入頁面顯示的資料
        {
            //var data = Array();
            var data =
            {
                tot_output_sum: "20000", tot_daily_expend: "3000", tot_patch_change: "13500", tot_sum: "9500",
                input_1000: "10000", input_100: "5000", input_50: "3000", input_10: "1000", input_5: "1000"
                
            };
            if (tot_output_sum == 0 && tot_daily_expend == 0 && tot_sum == 0) {
                $("#Daily_output_sum").val(0).toString();
                $("#Daily_expend_sum").val(0).toString();
                $("#Daily_patch_change").val(13500).toString();
                $("#Daily_sum").val(0).toString();
                $('#output_sum').val(0).toString();
            }
            else
            {
                //當日總額
                var tot_output_sum = data.tot_output_sum;
                var tot_daily_expend = data.tot_daily_expend;
                var tot_patch_change = data.tot_patch_change;
                var tot_sum = data.tot_sum;
                //當日現金收入
                var input_1000 = data.input_1000;
                var input_100 = data.input_100;
                var input_50 = data.input_50;
                var input_10 = data.input_10;
                var input_5 = data.input_5;
                //當日支出


                $("#Daily_output_sum").val(tot_output_sum.toString());
                $("#Daily_expend_sum").val((tot_daily_expend).toString());
                $("#Daily_patch_change").val(tot_patch_change).toString();
                $("#Daily_sum").val(tot_sum).toString();

                $("#input_1000").val(input_1000.toString());
                $("#input_100").val(input_100.toString());
                $("#input_50").val(input_50.toString());
                $("#input_10").val(input_10.toString());
                $("#input_5").val(input_5.toString());  
                $("#output_sum").val(tot_output_sum.toString());
            }
            //data.push(dataRow1);
        }
        function Update_Daily_Account()
        {
            //每日總額更新
            alert("Update_Daily_Account");
            
        }
        //列出所有支出類別
        function List_Expend_Category()
        {
            
            console.log(cat_value);
            var collegeSelect = document.getElementById("category_List");
            //取得類別列表
            var Cat_tableData = "";

            for (var i = 0; i < cat_value.length; i++) {
                //inner第一行就會像是 <option value=0>商學院</option>
                Cat_tableData = Cat_tableData + '<option value=' + cat_value[i].code + '>' + cat_value[i].text + ' </option>';
                
            }

            collegeSelect.innerHTML = Cat_tableData;

            List_Expend_Item();

            
            
        }
            //列出所有支出品項
        function List_Expend_Item()
        {
            //取得類別列表
            var collegeSelect = document.getElementById("category_List").value;
            //取得類別列表
            var itemsSelect = document.getElementById("cat_items");

            var Cat_tableData = "";
            for (var i = 0; i < item_value.length; i++)
            {
                //inner第一行就會像是 <option value=0>商學院</option>
                if (item_value[i].cat_code == collegeSelect)
                    Cat_tableData = Cat_tableData + '<option value=' + item_value[i].items_code + '>' + item_value[i].items_text + ' </option>';
            }

            itemsSelect.innerHTML = Cat_tableData;

        }
        
        function Load_ShortCut()
        {
            var ShortCutSelect = document.getElementById("SHORTCut");
            var ShortCut_tableData = "";
            for (var i = 0; i < shortcut_value.length; i++) {
                //inner第一行就會像是 <option value=0>商學院</option>
                //if (shortcut_value[i].cat_value == ShortCutSelect)
                ShortCut_tableData = ShortCut_tableData + '<button type=\"button\" class=\"btn btn-warning\" style=\"margin-right:5px\" onclick=\"Update_Add_Expand(\'' + shortcut_value[i].cat_code + '\' ,\'' + shortcut_value[i].items_code + '\' )\">' + shortcut_value[i].cat_value + '-' + shortcut_value[i].item_value + '</button>';
            }

            ShortCutSelect.innerHTML = ShortCut_tableData;
            
        }
        function Update_Add_Expand(catValue, itemVale)
        {
            $("#category_List").val(catValue);
            $("#cat_items").val(itemVale);

        }
        //var cat_value = [{ code: "A", text: "商學院" }, { code: "B", text: "工學院" }];
        // var item_value = [{ cat_code: "A", items_code: "1", items_text: "金融系" }, { cat_code: "A", items_code: "2", items_text: "商品系" },
        //{ cat_code: "B", items_code: "3", items_text: "資訊系" }, { cat_code: "B", items_code: "4", items_text: "電子系" }];

        function Add_Expend()
        {
            var catText, itemText;
            $.each(cat_value, function (catIndex,catItem) {
                if (catItem.code == $("#category_List").val()) {
                    catText = catItem.text;
                }
            });
            $.each(item_value, function (itemIndex, itemItem) {
                if (itemItem.items_code == $("#cat_items").val())
                {
                    itemText = itemItem.items_text;
                    console.log("same");
                }
                    
            });
            var Expend_amt = TryParseInt($("#cat_ExpendAmt").val());
            
            var tableData = "";
            Expend_seq++;
            tableData += "<tr>"
            tableData += "<td>" + Expend_seq + "</td>";
            tableData += "<td>" + catText + "</td>";
            tableData += "<td>" + itemText + "</td>";
            tableData += "<td>" + Expend_amt + "</td>";
            tableData += "<td> <input class=\"btn btn - outline - secondary\" type=\"button\" onclick=\"Delete_Expend(this," + Expend_amt+")\" value=\"刪除\" /> </td>";
            tableData += "</tr>";

            $("#tbody1").after(tableData);
            //$("#tbody1").html(tableData)
            tot_Expend_amt += Expend_amt;

            $("#Expend_count").val(Expend_seq).toString();
            $("#Total_Expend_Amt").val(tot_Expend_amt).toString();
            daily_sum();
            

        }
        function Delete_Expend(obj,delete_amt)
        {
            var isDelete = confirm("真的要刪除嗎？");
            if (isDelete) {
                var tr = obj.parentNode.parentNode;
                var tbody = tr.parentNode;
                tbody.removeChild(tr);
            }
            Expend_seq -= 1;
            tot_Expend_amt -= delete_amt;
            $("#Expend_count").val(Expend_seq).toString();
            $("#Total_Expend_Amt").val(tot_Expend_amt).toString();
            daily_sum();

        }
        function Send_Expend()
        {
            var tot_daily_expend = TryParseInt($("#Total_Expend_Amt").val());
            $("#Daily_expend_sum").val((tot_daily_expend).toString());
            daily_sum()
        }
        function daily_sum()
        {
            var input_1000 = TryParseInt($("#input_1000").val());
            var input_100 = TryParseInt($("#input_100").val());
            var input_50 = TryParseInt($("#input_50").val());
            var input_10 = TryParseInt($("#input_10").val());
            var input_5 = TryParseInt($("#input_5").val());

            var tot_daily_expend = TryParseInt($("#Total_Expend_Amt").val());
            var tot_dailty_patch = TryParseInt($("#Daily_patch_change").val());

            var output_sum = input_1000 + input_100 + input_10 + input_50 + input_5;
            var Daily_sum = output_sum - tot_dailty_patch + tot_daily_expend;


            $("#output_sum").val(output_sum.toString());
            $("#Daily_output_sum").val(output_sum.toString());
            $("#Daily_expend_sum").val((tot_daily_expend).toString());
            $("#Daily_sum").val(Daily_sum.toString());
            
        }
        function RunAjax_income(Action) {

            
            var input_1000 = TryParseInt($("#input_1000").val()).toString();
            var input_100 = TryParseInt($("#input_100").val()).toString();
            var input_50 = TryParseInt($("#input_50").val()).toString();
            var input_10 = TryParseInt($("#input_10").val()).toString();
            var input_5 = TryParseInt($("#input_5").val()).toString();

            
            var Msg = CheckMsg();
            if (Msg != "") {
                alert(Msg);
                return false;
            }

            var Info = {};
            Info.input_1000 = input_1000;
            Info.input_100 = input_100;
            Info.input_50 = input_50;
            Info.input_10 = input_10;
            Info.input_5 = input_5;
            Info.Action = Action;
            


            var jsonData = JSON.stringify(Info);
            console.log(jsonData);
            $.ajax({
                url: "xml/SignIn.ashx",
                data: jsonData,
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    var jsonObj;
                    var TotalPage;
                    if (typeof (data) == 'undefined' || data == null) {
                        jsonObj = "";
                    }
                    else {
                        jsonObj = data;
                    }
                    console.log(jsonObj);
                    if (jsonObj != "") {
                        if (jsonObj.length > 0) {
                            if (jsonObj[0].result == "OK") {
                                console.log("讀取成功");
                                $("#input_1000").val(jsonObj[0].input_1000);
                                $("#input_100").val(jsonObj[0].input_100);
                                $("#input_50").val(jsonObj[0].input_50);
                                $("#input_10").val(jsonObj[0].input_10);
                                $("#input_5").val(jsonObj[0].input_5);
                                //location.href = jsonObj[0].url;
                            }
                            else {
                                console.log(jsonObj[0].result);
                                alert(jsonObj[0].Msg);
                            }
                        }
                    }
                }
            });
        }
        function RunAjax_outcome(Action)
        {
            var category = $("#category").val().toString();
            var items = $("#items").val().toString();

            var Msg = CheckMsg();
            if (Msg != "") {
                alert(Msg);
                return false;
            }

            var Info = {};
            Info.category = category;
            Info.items = items;
            Info.Action = Action;


            var jsonData = JSON.stringify(Info);
            console.log(jsonData);
            $.ajax({
                url: "xml/SignIn.ashx",
                data: jsonData,
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
                success: function (data) {
                    var jsonObj;
                    var TotalPage;
                    if (typeof (data) == 'undefined' || data == null) {
                        jsonObj = "";
                    }
                    else {
                        jsonObj = data;
                    }
                    console.log(jsonObj);
                    if (jsonObj != "") {
                        if (jsonObj.length > 0) {
                            if (jsonObj[0].result == "OK") {
                                console.log("讀取成功");
                                $("#category").val(jsonObj[0].category).toString();
                                $("#items").val(jsonObj[0].items).toString();
                            }
                            else {
                                console.log(jsonObj[0].result);
                                alert(jsonObj[0].Msg);
                            }
                        }
                    }
                }
            });
        }


        function CheckMsg()
        {
            var Msg = "";
            var remainder_input_1000 = TryParseInt($("#input_1000").val()) % 1000;
            var remainder_input_100 = TryParseInt($("#input_100").val()) % 100;
            var remainder_input_50 = TryParseInt($("#input_50").val()) % 50;
            var remainder_input_10 = TryParseInt($("#input_10").val()) % 10;
            var remainder_input_5 = TryParseInt($("#input_5").val()) % 5;

            if (remainder_input_1000 != 0) { Msg += "1000元輸入有誤\n"; }
            if (remainder_input_100 != 0) { Msg += "100元輸入有誤\n"; }
            if (remainder_input_50 != 0) { Msg += "50元輸入有誤\n"; }
            if (remainder_input_10 != 0) { Msg += "10元輸入有誤\n"; }
            if (remainder_input_5 != 0) { Msg += "5元輸入有誤\n"; }
            
            
            
            return Msg;
        }
    </script>	
	
	

</html>


